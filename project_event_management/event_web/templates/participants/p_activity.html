{% extends "layout.html" %}

{% block title %}
Activity
{% endblock %}

{% block content %}

{% if user.role == "Participant" %}
<a href="{% url 'url_p_homepage' %}" class="btn_back"><b>Back</b></a>
{% elif user.role == 'Organizer'%}
<a href="{% url 'url_o_homepage' %}" class="btn_back"><b>Back</b></a>
{% endif %}

<div class="main_activity">
    <div class="ex2" style="margin-top: 120px;">
        <h2 class="ghost" style="color: white;">{{ activity.title }}</h2>
        <div class="ghost_ex" style="margin-top: 15px;">
            {% if user.role == "Participant" and not already_registration%}
            <button type="button" class="btn_regis_activity" data-toggle="modal" data-target="#registerModal">ลงทะเบียนกิจกรรม</button>
            {% elif user.role == "Participant" and already_registration%}
            <button class="btn_regis_activity" style="background-color: red;" data-toggle="modal" data-target="#cancelModal">ยกเลิกลงทะเบียนกิจกรรม</button>
            {% endif %}
        </div>
    </div>
</div>
<div class="main_activity">
    <div class="activity">
        <div class="pic_area">
            <div class="pic1">
                <img src="/static/pic/dog.jpg" alt="" class="big_pic">
            </div>
            <div class="pic2">
                <img src="/static/pic/dog.jpg" alt="" class="medium_pic">
            </div>
            <div class="pic3">
                <img src="/static/pic/dog.jpg" alt="" class="medium_pic">
            </div>
        </div>
        <div class="box1">
            <div class="box_content">
                <h5>{{ activity.close_register_date|date:"d M Y H:i A" }}</h5>
            </div>
            <div class="box_content">
                <h5>{{ activity.start_date|date:"d M Y H:i A" }}</h5>
            </div>
            <div class="box_content">
                <h5>{{ activity.due_date|date:"d M Y H:i A" }}</h5>
            </div>

            <!-- activity type -->
            {% if activity.activity_type == 'hybrid' %}
            <div class="box_content">
                <h5>{{ activity.platform }}</h5>
            </div>
            <div class="box_content">
                <h5>{{ activity.location }}</h5>
            </div>
            {% elif activity.activity_type == 'online' %}
            <div class="box_content">
                <h5>{{ activity.platform }}</h5>
            </div>
            {% elif activity.activity_type == 'onsite' %}
            <div class="box_content">
                <h5>{{ activity.location }}</h5>
            </div>
            {% endif %}

        </div>
        <div class="box2">
            <p>{{ activity.description }}</p>
        </div>
        <div class="box3">
            <p>{{ activity.contact }}</p>
        </div>
    </div>
</div>
<div class="main_activity" style="justify-content: center;">
    {% if user.role == "Participant" and not already_registration%}
    <button type="button" class="btn_regis_activity"  style=" padding: 20px; text-align: center;" data-toggle="modal" data-target="#registerModal"><h3>ลงทะเบียนกิจกรรม</h3></button>
    {% elif user.role == "Participant" and already_registration%}
    <button class="btn_regis_activity" style=" padding: 20px; text-align: center; background-color: red;" data-toggle="modal" data-target="#cancelModal"><h3>ยกเลิกลงทะเบียนกิจกรรม</h3></button>
    {% endif %}
</div>
  
  <!-- เข้าร่วมกิจกรรม Modal -->
  <div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="registerModalTitle">ลงทะเบียนกิจกรรม</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                คุณต้องการลงทะเบียนกิจกรรมนี้หรือไม่?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                <form method="POST" action="{% url 'url_p_activitypage' activity.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="register">
                    <button type="submit" class="btn_regis_activity">ยืนยัน</button>
                </form>
            </div>
        </div>
    </div>
</div>

  <!-- ยกเลิกเข้าร่มกิจกรรม Modal -->
  <div class="modal fade" id="cancelModal" tabindex="-1" role="dialog" aria-labelledby="cancelModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cancelModalTitle">ยกเลิกการลงทะเบียนกิจกรรม</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                คุณต้องการยกเลิกการลงทะเบียนกิจกรรมนี้หรือไม่?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">ยกเลิก</button>
                <form method="POST" action="{% url 'url_p_activitypage' activity.id %}">
                    {% csrf_token %}
                    <!-- ช่วยให้รู้ว่าปุ่มที่กดไปคือจะทำอะไร -->
                    <input type="hidden" name="action" value="cancel">
                    <button type="submit" class="btn_regis_activity">ยืนยัน</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}